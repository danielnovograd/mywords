var app=angular.module("Wordrly",["ui.router","Wordrly.lookups","Wordrly.services"]);app.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$stateProvider.state("home",{url:"/home",templateUrl:"/app/lookups/lookups.html",controller:"lookups"}),$urlRouterProvider.otherwise("home")}]),angular.module("Wordrly.lookups",[]).controller("lookups",function($scope,$http,$timeout,words){$scope.currentList=["Loading"],$scope.showLookups=!1,$scope.lookupList=words.lookupHistory,$scope.targetWord="",$scope.currentWord="",$scope.queryWord=function(){words.queryWord($scope.targetWord).then(function(response){$scope.currentWord=$scope.targetWord,$scope.wordDefinition=response.data[0],$scope.wordEtymology=response.data[1],($scope.wordDefinition.length>0||$scope.wordEtymology.length>0)&&(~$scope.lookupList.indexOf($scope.targetWord)||$scope.lookupList.push($scope.targetWord)),$scope.showLookups=!0})},$scope.pastLookup=function(word){words.queryWord(word).then(function(response){$scope.showLookups=!0,$scope.currentWord=word,$scope.wordDefinition=response.data[0],$scope.wordEtymology=response.data[1]})},$scope.save=function(word){words.saveToList({user:$scope.current,word:word,definition:$scope.wordDefinition.map(function(word){return word.text}),etymology:$scope.wordEtymology.map(function(entry){return entry.etymology})}).then(function(response){$scope.currentList=response.map(function(wordEntry){return wordEntry.word}).sort()})},$scope["delete"]=function(word){words.deleteFromList(word).then(function(response){$scope.currentList=response.map(function(wordEntry){return wordEntry.word}).sort()})},$scope.clearList=function(){confirm("Are you sure you want to delete?")&&($scope.currentList=words.clearList())},$timeout(function(){for(;!$scope.currentUser;)$scope.currentUser=prompt("Please enter a username")},500),words.loadList().then(function(response){$scope.currentList=response.map(function(wordEntry){return wordEntry.word}).sort()})}),angular.module("Wordrly.services",[]).factory("words",function($http){var currentList={},defaultUser="dan",loadList=function(){return $http({method:"POST",url:"/api/wordList/list",data:{user:defaultUser}}).then(function(response){return response.data})["catch"](function(error){console.log("loadList Error: ",error)})},clearList=function(){return $http({method:"POST",url:"/api/wordList/clear",data:JSON.stringify({user:defaultUser})}).then(function(response){return response.data})["catch"](function(error){console.log("clearList Error: ",error)})},queryWord=function(word){return $http({method:"POST",url:"/api/lookups/query",data:JSON.stringify({user:defaultUser,data:word})})},deleteFromList=function(word){return $http({method:"POST",url:"/api/wordList/delete",data:JSON.stringify({word:word,user:defaultUser})}).then(function(response){return response.data})["catch"](function(error){console.log("deleteFromList Error: ",error)})},saveToList=function(data){return $http({method:"POST",url:"/api/wordList/save",data:JSON.stringify({user:data.user,word:data})}).then(function(response){return response.data})["catch"](function(error){console.log("saveToList Error: ",error)})},lookupHistory=[];return{currentList:currentList,loadList:loadList,deleteFromList:deleteFromList,queryWord:queryWord,lookupHistory:lookupHistory,clearList:clearList,saveToList:saveToList}});