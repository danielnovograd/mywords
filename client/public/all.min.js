var app=angular.module("Wordrly",["ui.router","Wordrly.lookups","Wordrly.services"]);app.config(["$stateProvider","$urlRouterProvider",function(r,o){r.state("home",{url:"/home",templateUrl:"/app/lookups/lookups.html",controller:"lookups"}),o.otherwise("home")}]),angular.module("Wordrly.lookups",[]).controller("lookups",["$scope","$http","$timeout","words",function(r,o,t,e){r.currentList=["Loading..."],r.showLookups=!1,r.lookupList=e.lookupHistory,r.targetWord="",r.currentWord="",r.queryWord=function(){var o=r.targetWord.toLowerCase();e.queryWord(o).then(function(t){r.currentWord=r.targetWord,r.wordDefinition=t.data[0],r.wordEtymology=t.data[1],(r.wordDefinition.length>0||r.wordEtymology.length>0)&&(~r.lookupList.indexOf(o)||r.lookupList.push(o)),r.showLookups=!0})},r.pastLookup=function(o){e.queryWord(o).then(function(t){r.showLookups=!0,r.currentWord=o,r.wordDefinition=t.data[0],r.wordEtymology=t.data[1]})},r.save=function(o){e.saveToList({user:r.currentUser,wordObject:{word:o,definition:r.wordDefinition.map(function(r){return r.text}),etymology:r.wordEtymology.map(function(r){return r.etymology})}}).then(function(o){r.currentList=o.map(function(r){return r.word}).sort()})},r["delete"]=function(o){e.deleteFromList({user:r.currentUser,word:o}).then(function(o){r.currentList=o.map(function(r){return r.word}).sort()})},r.clearList=function(){confirm("Are you sure you want to delete?")&&(r.currentList=e.clearList(r.currentUser))},r.loadUser=function(){for(r.currentUser="";!r.currentUser;)r.currentUser=prompt("Please enter a username");e.loadList(r.currentUser).then(function(o){o.length>0?r.currentList=o.map(function(r){return r.word}).sort():r.currentList=[]})},t(r.loadUser,400)}]),angular.module("Wordrly.services",[]).factory("words",["$http",function(r){var o={},t=function(o){return r({method:"POST",url:"/api/wordList/list",data:JSON.stringify({username:o})}).then(function(r){return r.data})["catch"](function(r){console.log("loadList error: ",r)})},e=function(o){return r({method:"POST",url:"/api/lookups/query",data:JSON.stringify({wordQuery:o})})},n=function(o){return r({method:"POST",url:"/api/wordList/delete",data:JSON.stringify({username:o.user,word:o.word})}).then(function(r){return r.data})["catch"](function(r){console.log("deleteFromList Error: ",r)})},u=function(o){return r({method:"POST",url:"/api/wordList/clear",data:JSON.stringify({username:o})}).then(function(r){return r.data})["catch"](function(r){console.log("clearList Error: ",r)})},i=function(o){return r({method:"POST",url:"/api/wordList/save",data:JSON.stringify({username:o.user,word:o.wordObject})}).then(function(r){return r.data})["catch"](function(r){console.log("saveToList Error: ",r)})},s=[];return{currentList:o,loadList:t,deleteFromList:n,queryWord:e,lookupHistory:s,clearList:u,saveToList:i}}]);